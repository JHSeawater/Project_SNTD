# 프로젝트 기획서: Snake Defense (가제)

## 1. 개요 (Overview)
* **장르**: 아케이드 + 타워 디펜스 (Hybrid Strategy)
* **플랫폼**: PC (추후 모바일 확장 가능)
* **타겟**: 퍼즐과 전략 장르를 좋아하는 캐주얼 게이머
* **개발 엔진**: Unity 6 (2D)
* **핵심 컨셉**: "내가 움직인 경로가 곧 적들의 침입로가 된다."

---

## 2. 게임 루프 (Core Loop)
게임은 하나의 스테이지 안에서 두 가지 페이즈(Phase)로 나뉘어 진행된다.

1.  **Phase 1: 뱀 게임 (Map Creation)**
    * 플레이어는 뱀을 조작하여 사과를 먹고 몸집을 불린다.
    * 장애물과 자기 몸에 부딪히지 않고 '목적지(Goal)'에 도착해야 한다.
    * **전략 요소**: 몸통을 길게 만들수록 적의 이동 거리가 늘어나 방어에 유리하지만, 조작 난이도가 상승한다. 반대로 짧게 끝내면 방어 시간이 부족해진다.
2.  **Phase 2: 타워 디펜스 (Defense)**
    * 목적지에 도착하는 순간, 뱀의 몸통이 화석화되어 '적의 이동 경로'가 된다.
    * 플레이어는 뱀 게임 단계에서 획득한 재화(골드)로 타워를 건설한다.
    * 적들은 뱀의 꼬리 지점에서 생성되어 몸통을 밟고 머리(목적지)를 향해 진격한다.
    * 모든 웨이브를 막아내면 스테이지 클리어.

---

## 3. 상세 시스템 기획

### 3.1. Phase 1: 스네이크 모드
* **조작**: 방향키 (상, 하, 좌, 우)를 이용한 그리드 단위 이동.
* **기본 오브젝트**:
    * **뱀(Player)**: 0.2초(조절 가능) 간격으로 한 칸씩 이동.
    * **사과(Apple)**: 섭취 시 몸통 길이 +1, 골드 +10G 획득. 맵 상의 빈 공간에 랜덤 스폰.
    * **라이프(Life)**: 섭취 시 Phase 2의 기지 체력 상승.
    * **골드(Gold)**: 섭취 시 골드 +5G ~ +30G 획득. 맵 상의 빈 공간에 랜덤 스폰. 골드를 한 번 먹으면 사과를 먹어야만 맵에 새로운 골드 생성.
    * **설계도(Archi)**: 섭취 시 타워 무료 건설권 획득.
    * **벽(Wall)**: 맵의 경계. 충돌 시 게임 오버(또는 재시작).
    * **목적지(Goal)**: 충돌 시 Phase 1 종료 및 Phase 2 전환 트리거.
* **추가 오브젝트**:
    * **레거시 타워(Regacy)**: 맵 상에 원래부터 존재하던 타워. 충돌 시 게임 오버. 뱀의 경로를 통해 전략적으로 사용 가능.
    * **동굴(Cave)**: 뱀이 맵의 A지점에서 B지점으로 이동. Phase 2의 적들도 해당 동굴의 출입구를 통해 이동.
    * **늪(Mud)**: 해당 타일 위로 뱀의 몸통이 지나가게 하면, Phase 2에서 적들이 해당 타일에서 이동 속도가 느려지게 함.
    * **유물(Relic)**: 해당 타일 위에 타워를 건설하면 타워의 스탯 증가.
    * **금광(Gold Mine)**: 해당 타일 위로 뱀의 몸통이 지나가게 하면, Phase 2의 매 웨이브마다 추가 골드 획득.
* **특이 사항**:
    * 목적지에 도착 시, 현재까지 이어진 모든 몸통 좌표(`List<Vector3>`)를 저장(Bake)하여 경로로 변환.

### 3.2. Phase 2: 디펜스 모드
* **경로(Path)**: 뱀의 몸통이 변한 타일. 적은 이 위로만 이동 가능.
* **적(Enemy)**:
    * **생성**: 뱀의 꼬리(Start Point)에서 웨이브 단위로 생성.
    * **목표**: 경로를 따라 이동하여 뱀의 머리(Base)에 도달.
    * **피해**: 머리에 도달 시 플레이어 라이프(Life) 감소.
* **타워(Tower)**:
    * **배치**: 경로(몸통)가 아닌 빈 타일 공간에 건설 가능.
    * **공격**: 사거리 내의 적을 자동 공격.
    * **종류 (예시)**:
        * *레거시 타워*: 맵 상에 원래부터 존재하던 타워, 뱀의 경로를 통해 전략적으로 사용 가능.
        * *기본 타워*: 평균 사거리, 평균 데미지, 평균 공속, 대공.
        * *속사 타워*: 평균 사거리, 낮은 데미지, 빠른 공속.
        * *스나이퍼 타워*: 긴 사거리, 높은 데미지, 느린 공속, 대공.
        * *슬로우 타워*: 평균 사거리, 낮은 데미지, 낮은 공속, 적의 이동 속도 감소 (CC기).
        * *대공 타워*: 평균 사거리, 평균 데미지, 평균 공속, 대공만 가능.
        * *레이저 타워*: 긴 사거리, 높은 데이지, 느린 공속, 직선 광역 공격, 에너지 필수.
        * *플레임 타워*: 짧은 사거리, 낮은 데미지, 지속형 공속, 원뿔 광역 공격.
        * *포이즌 타워*: 짧은 사거리, 지속 데미지, 지속형 공속, 원형 광역 공격.
        * *드릴 타워*: 짧은 사거리, 높은 데미지, 느린 공속, 적이 받는 데미지 증가, 에너지 필수.
        * *버프 타워*: 주변 타워 버프 제공.
        * *에너지 타워*: 주변 타워 에너지 제공, 업그레이드 시 에너지 출력량 증가.
        * *생산 타워*: 지속적으로 골드 생산.
        * *그외 상위 호환 타워*: 하위 타워보다 높은 스탯, 고에너지 필수.

### 3.3. 재화 및 UI
* **골드 (Gold)**:
    * 획득: 골드 획득 시(+5G ~ +30G), 사과 섭취 시(+10G), 적 처치 시(+5G). 웨이브 종료 시(+100G)
    * 이자: 웨이브가 끝났을 경우, 남은 골드의 10%를 이자로 지급.
    * 사용: 타워 건설 및 업그레이드.
* **UI 구성**:
    * **상단**: 현재 점수, 골드, 남은 적 수 / 웨이브 정보.
    * **하단 (디펜스 모드 시)**: 타워 선택 패널.
    * **중앙**: 게임 오버 / 클리어 팝업.

---

## 4. 기술적 구현 로직 (개발자 노트)

### 4.1. 데이터 관리 (Data Structure)
* **Grid System**: 유니티 `Tilemap` 및 `Vector2Int` 활용.
* **Pathfinding**: 별도의 A* 알고리즘 불필요. 뱀의 `bodyParts` 리스트를 역순/정순으로 순회하여 적 이동.

### 4.2. 주요 클래스 설계
* `GameManager`: 전체 게임 상태(Phase) 관리 (SnakeState <-> DefenseState).
* `SnakeController`: 뱀 이동, 사과 섭취, 몸통 리스트 관리. `BakePath()` 함수로 경로 데이터 추출.
* `SpawnManager`: 사과 랜덤 생성 (OverlapCircle로 빈 공간 체크).
* `WaveManager`: 적 생성 주기 및 웨이브 관리.
* `EnemyMovement`: 웨이브 매니저로부터 받은 경로 데이터를 따라 이동 (`MoveTowards`).
* `Tower`: 적 감지(`Physics2D.OverlapCircle` or Trigger) 및 발사체 생성.

---

## 5. 추후 확장 아이디어 (To-Do)
* [ ] **지형지물**: 파괴 가능한 벽 등.
* [ ] **로그라이크 요소**: 스테이지 클리어 시 3가지 무작위 타워 중 하나 선택.
* [ ] **보스전**: 경로를 무시하거나 타워를 부수며 오는 거대 적.
